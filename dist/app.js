"use strict";function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}(),buttonClass="pp-button",buttonExpandClass="pp-expand",buttonContractClass="pp-contract",buttonExpandText="+",buttonContractText="-",messageClass="message",hiddenClass="pp-hidden",language="ruby",eventListId="event_list",listItemSelector=".event.colorized",listItemNodeName="LI",listItemHoverClass="pp-hover",beautifyConfig={indent_size:2},mutationConfig={childList:!0},ListItem=function(){function t(e){_classCallCheck(this,t),this.node=e,this.message=null,this.prettyMessage=null,this.expandButton=null,this.contractButton=null,this.addButtons(),this.setDefaultButtonState(),this.addHoverListener()}return _createClass(t,[{key:"addHoverListener",value:function(){var t=this;this.node.addEventListener("mouseover",function(){t.node.classList.add(listItemHoverClass)}),this.node.addEventListener("mouseout",function(){t.node.classList.remove(listItemHoverClass)})}},{key:"setDefaultButtonState",value:function(){this.expandButton.show(),this.contractButton.hide()}},{key:"addButtons",value:function(){this.expandButton=new ExpandButton(this.expandPretty.bind(this)),this.contractButton=new ContractButton(this.contractPretty.bind(this)),this.node.insertBefore(this.expandButton.node,this.node.firstChild),this.node.insertBefore(this.contractButton.node,this.node.firstChild)}},{key:"expandPretty",value:function(){this.ensureMessages(),this.message.classList.add(hiddenClass),this.prettyMessage.classList.remove(hiddenClass),this.expandButton.hide(),this.contractButton.show()}},{key:"contractPretty",value:function(){this.ensureMessages(),this.message.classList.remove(hiddenClass),this.prettyMessage.classList.add(hiddenClass),this.expandButton.show(),this.contractButton.hide()}},{key:"ensureMessages",value:function(){this.message&&this.prettyMessage||(this.getMessage(),this.getPrettyMessage())}},{key:"getMessage",value:function(){for(var t=0;t<this.node.childNodes.length;t++){var e=this.node.childNodes[t];if(e.classList&&e.classList.contains(messageClass)){var s=e;return this.message=e,s}}return null}},{key:"getPrettyMessage",value:function(){var t=document.createElement("pre"),e=js_beautify(this.message.innerText,beautifyConfig);return t.innerHTML=e,t.classList.add(language),hljs.highlightBlock(t),this.prettyMessage=t,this.node.insertBefore(this.prettyMessage,this.message),t}}]),t}(),Button=function(){function t(e,s,n){_classCallCheck(this,t),this.node=document.createElement("button"),this.node.innerHTML=e,this.node.classList.add(buttonClass),this.node.classList.add(s),this.node.addEventListener("click",n)}return _createClass(t,[{key:"show",value:function(){this.node.classList.remove(hiddenClass)}},{key:"hide",value:function(){this.node.classList.add(hiddenClass)}}]),t}(),ExpandButton=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,buttonExpandText,buttonExpandClass,t))}return _inherits(e,t),e}(Button),ContractButton=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,buttonContractText,buttonContractClass,t))}return _inherits(e,t),e}(Button),View=function(){function t(){_classCallCheck(this,t),this.eventList=document.getElementById(eventListId),this.listItems=document.querySelectorAll(listItemSelector)}return _createClass(t,[{key:"init",value:function(){this.eventList&&(this.initListItems(),this.watchListItems())}},{key:"initListItems",value:function(){for(var t=0;t<this.listItems.length;t++){var e=this.listItems[t];new ListItem(e)}}},{key:"watchListItems",value:function(){var t=new MutationObserver(function(t){for(var e=0;e<t.length;e++){var s=t[e],n=s.addedNodes;if(n&&n.length>0)for(var i=0;i<n.length;i++){var o=n[i];o.nodeName===listItemNodeName&&new ListItem(o)}}});t.observe(this.eventList,mutationConfig)}}]),t}();(new View).init();